{% extends 'base.html.twig' %}

{% block title %}Import from LastFm{% endblock %}

{% block body %}
  <div>
    <h1>My Account</h1>
  </div>

  <div>
    <h2>Last imports</h2>

    {% if imports is empty %}
      <p>No imports yet</p>
    {% else %}
      <ul>
        {% for import in imports %}

          {%  if import.started == false %}
            {%  set infoMessage = "Task not started" %}
          {%  elseif import.error == true %}
            {%  set infoMessage = "Task aborted with error : " ~ import.errorMessage %}
          {%  elseif import.finalized == true %}
            {%  set infoMessage = "Task finalized, " ~ import.finalizedScrobble ~ " scrobble(s) imported" %}
          {%  else %}
            {%  set infoMessage = "Task in progress, " ~ import.finalizedScrobble ~ " scrobble(s) imported out of " ~ import.totalScrobble %}
          {%  endif %}

          <li>{{ import.date|date('m/d/Y H:i:s') }} - {{ infoMessage }} </li>
        {% endfor %}
      </ul>
    {% endif %}

  </div>

  <div>
    <h2>Get last scrobbles from Last Fm</h2>
    <p><a href="/myAccount/updateScrobble">Start import</a></p>
  </div>

{% endblock %}